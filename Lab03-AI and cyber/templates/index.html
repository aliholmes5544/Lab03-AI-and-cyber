<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Titanic Survival Predictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Video Background - Light Mode -->
    <video class="video-bg light-video" autoplay muted loop playsinline>
        <source src="{{ url_for('static', filename='img/light_mode.mp4') }}" type="video/mp4">
    </video>

    <!-- Video Background - Dark Mode -->
    <video class="video-bg dark-video" autoplay muted loop playsinline>
        <source src="{{ url_for('static', filename='img/dark_mode.mp4') }}" type="video/mp4">
    </video>
    <!-- Page 1: Language & Theme Selection -->
    <div class="intro-page" id="langPage" {% if prediction %}style="display: none !important;"{% endif %}>
        <div class="intro-container">
            <div class="intro-logo">
                <img src="{{ url_for('static', filename='titanic-logo.svg') }}" alt="Titanic Logo">
            </div>
            <h1 class="intro-title">Welcome / ŸÖÿ±ÿ≠ÿ®ÿßŸã</h1>

            <!-- Theme Selection -->
            <p class="intro-subtitle">Select theme / ÿßÿÆÿ™ÿ± ÿßŸÑŸÖÿ∏Ÿáÿ±</p>
            <div class="theme-buttons">
                <button class="theme-btn" id="selectLight">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <span>Light</span>
                </button>
                <button class="theme-btn" id="selectDark">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <span>Dark</span>
                </button>
            </div>

            <!-- Language Selection -->
            <p class="intro-subtitle" style="margin-top: 30px;">Select language / ÿßÿÆÿ™ÿ± ŸÑÿ∫ÿ™ŸÉ</p>
            <div class="lang-buttons">
                <button class="lang-btn" id="selectEnglish">
                    <img class="lang-flag-img" src="{{ url_for('static', filename='img/british_flag.png') }}" alt="English">
                    <span>English</span>
                </button>
                <button class="lang-btn" id="selectArabic">
                    <img class="lang-flag-img" src="{{ url_for('static', filename='img/qatar_flag.png') }}" alt="ÿßŸÑÿπÿ±ÿ®Ÿäÿ©">
                    <span>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Page 2: Titanic Story Summary -->
    <div class="intro-page hidden" id="storyPage" {% if prediction %}style="display: none !important;"{% endif %}>
        <div class="intro-container story-container">
            <h1 class="story-title" data-en="The Titanic Story" data-ar="ŸÇÿµÿ© ÿ™Ÿäÿ™ÿßŸÜŸäŸÉ">The Titanic Story</h1>
            <div class="story-content">
                <p data-en="On April 15, 1912, the RMS Titanic, the largest and most luxurious ship of its time, sank in the North Atlantic Ocean after colliding with an iceberg during her maiden voyage from Southampton to New York City."
                   data-ar="ŸÅŸä 15 ÿ£ÿ®ÿ±ŸäŸÑ 1912ÿå ÿ∫ÿ±ŸÇÿ™ ÿ≥ŸÅŸäŸÜÿ© ÿ¢ÿ± ÿ•ŸÖ ÿ•ÿ≥ ÿ™Ÿäÿ™ÿßŸÜŸäŸÉÿå ÿ£ŸÉÿ®ÿ± Ÿàÿ£ŸÅÿÆŸÖ ÿ≥ŸÅŸäŸÜÿ© ŸÅŸä ÿπÿµÿ±Ÿáÿßÿå ŸÅŸä ÿßŸÑŸÖÿ≠Ÿäÿ∑ ÿßŸÑÿ£ÿ∑ŸÑÿ≥Ÿä ÿßŸÑÿ¥ŸÖÿßŸÑŸä ÿ®ÿπÿØ ÿßÿµÿ∑ÿØÿßŸÖŸáÿß ÿ®ÿ¨ÿ®ŸÑ ÿ¨ŸÑŸäÿØŸä ÿÆŸÑÿßŸÑ ÿ±ÿ≠ŸÑÿ™Ÿáÿß ÿßŸÑÿ£ŸàŸÑŸâ ŸÖŸÜ ÿ≥ÿßŸàÿ´ŸáÿßŸÖÿ®ÿ™ŸàŸÜ ÿ•ŸÑŸâ ŸÖÿØŸäŸÜÿ© ŸÜŸäŸàŸäŸàÿ±ŸÉ.">
                    On April 15, 1912, the RMS Titanic, the largest and most luxurious ship of its time, sank in the North Atlantic Ocean after colliding with an iceberg during her maiden voyage from Southampton to New York City.
                </p>
                <p data-en="Of the estimated 2,224 passengers and crew aboard, more than 1,500 died, making it one of the deadliest peacetime maritime disasters in history."
                   data-ar="ŸÖŸÜ ÿ®ŸäŸÜ ŸÖÿß ŸäŸÇÿØÿ± ÿ®ŸÄ 2,224 ÿ±ÿßŸÉÿ®ÿßŸã Ÿàÿ∑ÿßŸÇŸÖÿßŸã ÿπŸÑŸâ ŸÖÿ™ŸÜŸáÿßÿå ÿ™ŸàŸÅŸä ÿ£ŸÉÿ´ÿ± ŸÖŸÜ 1,500 ÿ¥ÿÆÿµÿå ŸÖŸÖÿß ÿ¨ÿπŸÑŸáÿß Ÿàÿßÿ≠ÿØÿ© ŸÖŸÜ ÿ£ŸÉÿ´ÿ± ÿßŸÑŸÉŸàÿßÿ±ÿ´ ÿßŸÑÿ®ÿ≠ÿ±Ÿäÿ© ÿØŸÖŸàŸäÿ© ŸÅŸä ŸàŸÇÿ™ ÿßŸÑÿ≥ŸÑŸÖ ŸÅŸä ÿßŸÑÿ™ÿßÿ±ŸäÿÆ.">
                    Of the estimated 2,224 passengers and crew aboard, more than 1,500 died, making it one of the deadliest peacetime maritime disasters in history.
                </p>
                <p data-en="The disaster shocked the world and led to major improvements in maritime safety regulations."
                   data-ar="ÿµÿØŸÖÿ™ ÿßŸÑŸÉÿßÿ±ÿ´ÿ© ÿßŸÑÿπÿßŸÑŸÖ Ÿàÿ£ÿØÿ™ ÿ•ŸÑŸâ ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© ŸÅŸä ŸÑŸàÿßÿ¶ÿ≠ ÿßŸÑÿ≥ŸÑÿßŸÖÿ© ÿßŸÑÿ®ÿ≠ÿ±Ÿäÿ©.">
                    The disaster shocked the world and led to major improvements in maritime safety regulations.
                </p>
                <p class="story-question" data-en="Would you have survived the Titanic? Let's find out!"
                   data-ar="ŸáŸÑ ŸÉŸÜÿ™ ÿ≥ÿ™ŸÜÿ¨Ÿà ŸÖŸÜ ÿ™Ÿäÿ™ÿßŸÜŸäŸÉÿü ŸÑŸÜŸÉÿ™ÿ¥ŸÅ!">
                    Would you have survived the Titanic? Let's find out!
                </p>
            </div>
            <button class="ok-btn" id="okBtn" data-en="OK" data-ar="ÿ≠ÿ≥ŸÜÿßŸã">OK</button>
        </div>
    </div>

    <!-- Main App (hidden initially, shown if prediction exists) -->
    <div class="main-app" id="mainApp" {% if not prediction %}style="display: none;"{% endif %}>
    {% if prediction %}
    <div class="modal-backdrop {% if prediction.survived %}survival{% else %}death{% endif %}" id="predictionModal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-header">
                {% if prediction.survived %}
                <h2 id="modalTitle" data-en="üéâ Congratulations! You Survived!" data-ar="üéâ ÿ™ŸáÿßŸÜŸäŸÜÿß! ŸÑŸÇÿØ ŸÜÿ¨Ÿàÿ™!">üéâ Congratulations! You Survived!</h2>
                {% else %}
                <h2 id="modalTitle" data-en="üíÄ Rest in Peace" data-ar="üíÄ ÿßÿ±ŸÇÿØ ÿ®ÿ≥ŸÑÿßŸÖ">üíÄ Rest in Peace</h2>
                {% endif %}
                <button class="close-btn" id="closeModalBtn" aria-label="Close">&times;</button>
            </div>

            <div class="modal-body">
                <div class="modal-row">
                    <div class="modal-card">
                        <div class="image-wrap">
                            {% if prediction.survived %}
                                {% if form_data.sex == 'female' %}
                                <img id="genderImg"
                                     class="survival-image"
                                     alt="Female survivor"
                                     src="{{ url_for('static', filename='img/survivor_female.png') }}">
                                {% else %}
                                <img id="genderImg"
                                     class="survival-image"
                                     alt="Male survivor"
                                     src="{{ url_for('static', filename='img/survivor_male.png') }}">
                                {% endif %}
                            {% else %}
                                <img id="genderImg"
                                     class="death-image"
                                     alt="Did not survive"
                                     src="{{ url_for('static', filename='img/drowning_dark.png') }}">
                            {% endif %}
                        </div>
                        <p class="modal-hint" data-en="Passenger: {{ 'Female' if form_data.sex == 'female' else 'Male' }}" data-ar="ÿßŸÑÿ±ÿßŸÉÿ®: {{ 'ÿ£ŸÜÿ´Ÿâ' if form_data.sex == 'female' else 'ÿ∞ŸÉÿ±' }}">
                            Passenger: {{ 'Female' if form_data.sex == 'female' else 'Male' }}
                        </p>
                    </div>

                    <div class="modal-card">
                        {% if prediction.survived %}
                        <p style="font-size: 16px; margin-bottom: 10px; color: #166534;" data-en="You would have survived the Titanic disaster!" data-ar="ŸÉŸÜÿ™ ÿ≥ÿ™ŸÜÿ¨Ÿà ŸÖŸÜ ŸÉÿßÿ±ÿ´ÿ© ÿ™Ÿäÿ™ÿßŸÜŸäŸÉ!">
                            You would have survived the Titanic disaster!
                        </p>
                        <div class="popup-confetti">
                            <span>üéâ</span><span>‚≠ê</span><span>‚ú®</span><span>üéä</span><span>üåü</span>
                        </div>
                        {% else %}
                        <p style="font-size: 16px; margin-bottom: 10px;" data-en="Unfortunately, you would not have survived..." data-ar="ŸÑŸÑÿ£ÿ≥ŸÅÿå ŸÑŸÖ ÿ™ŸÉŸÜ ŸÑÿ™ŸÜÿ¨Ÿà...">
                            Unfortunately, you would not have survived...
                        </p>
                        <div class="popup-skulls">
                            <span>üíÄ</span><span>‚ö∞Ô∏è</span><span>ü•Ä</span><span>‚ö∞Ô∏è</span><span>üíÄ</span>
                        </div>
                        <div class="blood-overlay"></div>
                        {% endif %}

                        <div class="modal-probability">
                            <p class="probability-text" data-en="Survival Probability: {{ '%.1f'|format(prediction.probability * 100) }}%" data-ar="ÿßÿ≠ÿ™ŸÖÿßŸÑ ÿßŸÑŸÜÿ¨ÿßÿ©: {{ '%.1f'|format(prediction.probability * 100) }}%">
                                Survival Probability: {{ "%.1f"|format(prediction.probability * 100) }}%
                            </p>
                            <div class="probability-bar">
                                <div class="probability-fill" style="width: {{ prediction.probability * 100 }}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="modal-btn" id="closeBtn" data-en="Close" data-ar="ÿ•ÿ∫ŸÑÿßŸÇ">Close</button>
                <button class="modal-btn primary" id="tryAgainBtn" data-en="Try Again" data-ar="ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ">Try Again</button>
            </div>
        </div>
    </div>
    {% endif %}
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='titanic-logo.svg') }}" alt="Titanic Logo" class="qatar-logo">
            </div>
            <h1 data-en="Titanic Survival Predictor" data-ar="ŸÖÿ™ŸÜÿ®ÿ¶ ÿßŸÑŸÜÿ¨ÿßÿ© ŸÖŸÜ ÿ™Ÿäÿ™ÿßŸÜŸäŸÉ">Titanic Survival Predictor</h1>
            <p class="subtitle" data-en="Machine Learning Classification Model" data-ar="ŸÜŸÖŸàÿ∞ÿ¨ ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ¢ŸÑŸä">Machine Learning Classification Model</p>
        </div>

        {% if error %}
        <div class="alert error">
            <h2 data-en="Error" data-ar="ÿÆÿ∑ÿ£">Error</h2>
            <p>{{ error }}</p>
        </div>
        {% endif %}

        {% if prediction %}
        <div class="alert {% if prediction.survived %}success{% else %}danger{% endif %}">
            <h2 data-en="Prediction Result" data-ar="ŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑÿ™ŸÜÿ®ÿ§">Prediction Result</h2>
            <div class="result-container">
                {% if prediction.survived %}
                    <img src="{{ url_for('static', filename='male-survivor.svg') }}" alt="Survivor" class="result-icon survivor-icon">
                    <p class="result">
                        <span class="survived" data-en="Survived" data-ar="ŸÜÿ¨ÿß">Survived</span>
                    </p>
                {% else %}
                    <img src="{{ url_for('static', filename='skull-death.svg') }}" alt="Did not survive" class="result-icon death-icon">
                    <p class="result">
                        <span class="not-survived" data-en="Did Not Survive" data-ar="ŸÑŸÖ ŸäŸÜÿ¨Ÿè">Did Not Survive</span>
                    </p>
                    <div class="blood-drips">
                        <div class="blood-drip"></div>
                        <div class="blood-drip"></div>
                        <div class="blood-drip"></div>
                        <div class="blood-drip"></div>
                        <div class="blood-drip"></div>
                    </div>
                {% endif %}
            </div>
            <p class="probability">
                <span data-en="Survival Probability:" data-ar="ÿßÿ≠ÿ™ŸÖÿßŸÑ ÿßŸÑŸÜÿ¨ÿßÿ©:">Survival Probability:</span> {{ "%.1f"|format(prediction.probability * 100) }}%
            </p>
            <div class="probability-bar">
                <div class="probability-fill" style="width: {{ prediction.probability * 100 }}%"></div>
            </div>
        </div>
        {% endif %}

        <form action="/predict" method="POST">
            <div class="form-row">
                <div class="form-group">
                    <label for="pclass" data-en="Passenger Class" data-ar="ÿØÿ±ÿ¨ÿ© ÿßŸÑÿ±ÿßŸÉÿ®">Passenger Class</label>
                    <select name="pclass" id="pclass" required>
                        <option value="1" {% if form_data and form_data.pclass == '1' %}selected{% endif %} data-en="1st Class" data-ar="ÿßŸÑÿØÿ±ÿ¨ÿ© ÿßŸÑÿ£ŸàŸÑŸâ">1st Class</option>
                        <option value="2" {% if form_data and form_data.pclass == '2' %}selected{% endif %} data-en="2nd Class" data-ar="ÿßŸÑÿØÿ±ÿ¨ÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©">2nd Class</option>
                        <option value="3" {% if form_data and form_data.pclass == '3' %}selected{% endif %} {% if not form_data %}selected{% endif %} data-en="3rd Class" data-ar="ÿßŸÑÿØÿ±ÿ¨ÿ© ÿßŸÑÿ´ÿßŸÑÿ´ÿ©">3rd Class</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="sex" data-en="Sex" data-ar="ÿßŸÑÿ¨ŸÜÿ≥">Sex</label>
                    <select name="sex" id="sex" required>
                        <option value="male" {% if form_data and form_data.sex == 'male' %}selected{% endif %} data-en="Male" data-ar="ÿ∞ŸÉÿ±">Male</option>
                        <option value="female" {% if form_data and form_data.sex == 'female' %}selected{% endif %} data-en="Female" data-ar="ÿ£ŸÜÿ´Ÿâ">Female</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="age" data-en="Age" data-ar="ÿßŸÑÿπŸÖÿ±">Age</label>
                    <input type="number" name="age" id="age" min="0" max="120" step="0.5"
                           value="{{ form_data.age if form_data else '30' }}" required>
                </div>

                <div class="form-group">
                    <label for="fare" data-en="Fare" data-ar="ÿßŸÑÿ≥ÿπÿ±">Fare</label>
                    <input type="number" name="fare" id="fare" min="0" step="0.01"
                           value="{{ form_data.fare if form_data else '32.00' }}" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="sibsp" data-en="Siblings / Spouses" data-ar="ÿßŸÑÿ£ÿ¥ŸÇÿßÿ° / ÿßŸÑÿ£ÿ≤Ÿàÿßÿ¨">Siblings / Spouses</label>
                    <input type="number" name="sibsp" id="sibsp" min="0" max="10"
                           value="{{ form_data.sibsp if form_data else '0' }}" required>
                </div>

                <div class="form-group">
                    <label for="parch" data-en="Parents / Children" data-ar="ÿßŸÑŸàÿßŸÑÿØŸäŸÜ / ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ">Parents / Children</label>
                    <input type="number" name="parch" id="parch" min="0" max="10"
                           value="{{ form_data.parch if form_data else '0' }}" required>
                </div>
            </div>

            <div class="form-group">
                <label for="embarked" data-en="Port of Embarkation" data-ar="ŸÖŸäŸÜÿßÿ° ÿßŸÑÿµÿπŸàÿØ">Port of Embarkation</label>
                <select name="embarked" id="embarked" required>
                    <option value="S" {% if form_data and form_data.embarked == 'S' %}selected{% endif %} data-en="Southampton (S)" data-ar="ÿ≥ÿßŸàÿ´ŸáÿßŸÖÿ®ÿ™ŸàŸÜ (S)">Southampton (S)</option>
                    <option value="C" {% if form_data and form_data.embarked == 'C' %}selected{% endif %} data-en="Cherbourg (C)" data-ar="ÿ¥Ÿäÿ±ÿ®Ÿàÿ±ÿ∫ (C)">Cherbourg (C)</option>
                    <option value="Q" {% if form_data and form_data.embarked == 'Q' %}selected{% endif %} data-en="Queenstown (Q)" data-ar="ŸÉŸàŸäŸÜÿ≤ÿ™ÿßŸàŸÜ (Q)">Queenstown (Q)</option>
                </select>
            </div>

            <button type="submit" class="btn" data-en="Predict Survival" data-ar="ÿ™ŸàŸÇÿπ ÿßŸÑŸÜÿ¨ÿßÿ©">Predict Survival</button>
        </form>

        <div class="footer" data-en="Powered by Scikit-learn RandomForest Classifier" data-ar="ŸÖÿØÿπŸàŸÖ ÿ®Ÿàÿßÿ≥ÿ∑ÿ© Scikit-learn RandomForest">
            Powered by Scikit-learn RandomForest Classifier
        </div>
    </div>
    </div> <!-- Close main-app -->

    <script>
        const body = document.body;

        // Intro pages elements
        const langPage = document.getElementById('langPage');
        const storyPage = document.getElementById('storyPage');
        const mainApp = document.getElementById('mainApp');
        const selectEnglish = document.getElementById('selectEnglish');
        const selectArabic = document.getElementById('selectArabic');
        const selectLight = document.getElementById('selectLight');
        const selectDark = document.getElementById('selectDark');
        const okBtn = document.getElementById('okBtn');

        // Set language function
        function setLanguage(lang) {
            body.setAttribute('data-lang', lang);
            document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            document.documentElement.setAttribute('lang', lang);

            // Update all translatable elements
            document.querySelectorAll('[data-en][data-ar]').forEach(el => {
                el.textContent = el.getAttribute(`data-${lang}`);
            });
        }

        // Check if there's a prediction result - apply saved language
        {% if prediction %}
        const savedLang = sessionStorage.getItem('selectedLang') || 'en';
        setLanguage(savedLang);
        // Clear after using so it resets on next fresh visit
        {% endif %}

        // Language selection handlers
        if (selectEnglish) {
            selectEnglish.addEventListener('click', () => {
                sessionStorage.setItem('selectedLang', 'en');
                setLanguage('en');
                langPage.style.display = 'none';
                storyPage.classList.remove('hidden');
                storyPage.style.display = 'flex';
            });
        }

        if (selectArabic) {
            selectArabic.addEventListener('click', () => {
                sessionStorage.setItem('selectedLang', 'ar');
                setLanguage('ar');
                langPage.style.display = 'none';
                storyPage.classList.remove('hidden');
                storyPage.style.display = 'flex';
            });
        }

        // Theme selection handlers
        function setTheme(theme) {
            body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            // Update button active states
            if (selectLight && selectDark) {
                selectLight.classList.toggle('active', theme === 'light');
                selectDark.classList.toggle('active', theme === 'dark');
            }
        }

        if (selectLight) {
            selectLight.addEventListener('click', () => {
                setTheme('light');
            });
        }

        if (selectDark) {
            selectDark.addEventListener('click', () => {
                setTheme('dark');
            });
        }

        // OK button handler
        if (okBtn) {
            okBtn.addEventListener('click', () => {
                storyPage.style.display = 'none';
                mainApp.style.display = 'block';
            });
        }

        // Apply saved theme preference or default to light
        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);

        // Prediction Modal
        const predictionModal = document.getElementById('predictionModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const closeBtn = document.getElementById('closeBtn');
        const tryAgainBtn = document.getElementById('tryAgainBtn');

        function openModal() {
            if (predictionModal) {
                predictionModal.classList.add('is-open');
                predictionModal.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal() {
            if (predictionModal) {
                predictionModal.classList.remove('is-open');
                predictionModal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
            }
        }

        if (predictionModal) {
            // Show modal with animation
            setTimeout(() => {
                openModal();
            }, 300);

            // Close buttons - just close the modal
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', closeModal);
            }
            if (closeBtn) {
                closeBtn.addEventListener('click', closeModal);
            }

            // Try Again - close modal and hide results
            if (tryAgainBtn) {
                tryAgainBtn.addEventListener('click', () => {
                    closeModal();
                    // Hide the prediction result alert
                    const resultAlert = document.querySelector('.alert.success, .alert.danger');
                    if (resultAlert) {
                        resultAlert.style.display = 'none';
                    }
                });
            }

            // Close on overlay click
            predictionModal.addEventListener('click', (e) => {
                if (e.target === predictionModal) {
                    closeModal();
                }
            });

            // Close on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && predictionModal.classList.contains('is-open')) {
                    closeModal();
                }
            });
        }
    </script>
</body>
</html>
